"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[702],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>y});var s=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,s,o=function(e,t){if(null==e)return{};var n,s,o={},a=Object.keys(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=s.createContext({}),c=function(e){var t=s.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=c(e.components);return s.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},h=s.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(n),h=o,y=u["".concat(l,".").concat(h)]||u[h]||d[h]||a;return n?s.createElement(y,r(r({ref:t},p),{},{components:n})):s.createElement(y,r({ref:t},p))}));function y(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,r=new Array(a);r[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:o,r[1]=i;for(var c=2;c<a;c++)r[c]=n[c];return s.createElement.apply(null,r)}return s.createElement.apply(null,n)}h.displayName="MDXCreateElement"},5224:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var s=n(7462),o=(n(7294),n(3905));const a={sidebar_position:2},r="API client",i={unversionedId:"web-client/api-client",id:"web-client/api-client",title:"API client",description:"To begin our client implementation we will create an interface that will connect to our relying party API. This interface will allow our React application to make calls to our relying party API, without having to create duplicate code.",source:"@site/docs/web-client/api-client.md",sourceDirName:"web-client",slug:"/web-client/api-client",permalink:"/docs/web-client/api-client",draft:!1,editUrl:"https://github.com/YubicoLabs/passkey-workshop/tree/main/docs/docs/web-client/api-client.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"User flows",permalink:"/docs/web-client/user-flows"},next:{title:"Registration flows",permalink:"/docs/web-client/reg-flow"}},l={},c=[{value:"Base URL",id:"base-url",level:2},{value:"Registration methods",id:"registration-methods",level:2},{value:"Get attestation options",id:"get-attestation-options",level:3},{value:"Send attestation result",id:"send-attestation-result",level:3},{value:"Authentication methods",id:"authentication-methods",level:2},{value:"Get assertion options",id:"get-assertion-options",level:3},{value:"Send assertion result",id:"send-assertion-result",level:3},{value:"Credential management APIs",id:"credential-management-apis",level:2},{value:"Get all passkeys",id:"get-all-passkeys",level:3},{value:"Delete passkey",id:"delete-passkey",level:3},{value:"Rename passkey",id:"rename-passkey",level:3}],p={toc:c},u="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,s.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"api-client"},"API client"),(0,o.kt)("p",null,"To begin our client implementation we will create an interface that will connect to our ",(0,o.kt)("a",{parentName:"p",href:"/docs/relying-party/api-def"},"relying party API"),". This interface will allow our React application to make calls to our relying party API, without having to create duplicate code."),(0,o.kt)("p",null,"The methods, and their associated flows will be covered in detail in the following pages, so for now don't get caught up in the details."),(0,o.kt)("h2",{id:"base-url"},"Base URL"),(0,o.kt)("p",null,"If you are following along with this guide, the URL for the API is as follows"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'const baseURL = "http://localhost:8080/v1";\n')),(0,o.kt)("p",null,"This URL is hardcoded, so ensure that you utilize something like an environment variable for your production deployment."),(0,o.kt)("h2",{id:"registration-methods"},"Registration methods"),(0,o.kt)("p",null,"The following methods will be used for the registration (creation), of new passkeys. For the remainder of this section, any use of attestation will refer to registration."),(0,o.kt)("h3",{id:"get-attestation-options"},"Get attestation options"),(0,o.kt)("p",null,"This method will allow you to get the attestation options from your relying party."),(0,o.kt)("p",null,"More details on these properties can be found on the ",(0,o.kt)("a",{parentName:"p",href:"/docs/relying-party/reg-flow#request"},"relying party registration flow page"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'async function getAttestationOptions(\n  username,\n  residentKeyReq,\n  authAttachment,\n  uvReq,\n  attestation\n) {\n  try {\n    const reqData = {\n      userName: username,\n      displayName: username,\n      authenticatorSelection: {\n        residentKey: residentKeyReq,\n        authenticatorAttachment: authAttachment,\n        userVerification: uvReq,\n      },\n      attestation: attestation,\n    };\n\n    const requestOptions = {\n      method: "POST",\n      headers: {\n        "Content-Type": "application/json",\n      },\n      body: JSON.stringify(reqData),\n    };\n\n    const response = await fetch(\n      `${baseURL}/attestation/options`,\n      requestOptions\n    );\n    const responseJSON = await response.json();\n\n    console.info("Printing registration options");\n    console.info(responseJSON);\n\n    return responseJSON;\n  } catch (e) {\n    console.error("There was an issue getting your registration options");\n    console.error(e.message);\n    throw e;\n  }\n}\n')),(0,o.kt)("h3",{id:"send-attestation-result"},"Send attestation result"),(0,o.kt)("p",null,"This method will allow you to send the newly created passkey to be registered in your relying party."),(0,o.kt)("p",null,"More details on these properties can be found on the ",(0,o.kt)("a",{parentName:"p",href:"/docs/relying-party/reg-flow#request-1"},"relying party registration flow page"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'async function sendAttestationResult(requestID, makeCredentialResponse) {\n  try {\n    const reqData = {\n      requestId: requestID,\n      makeCredentialResult: makeCredentialResponse,\n    };\n\n    const requestOptions = {\n      method: "POST",\n      headers: {\n        "Content-Type": "application/json",\n      },\n      body: JSON.stringify(reqData),\n    };\n\n    const response = await fetch(\n      `${baseURL}/attestation/result`,\n      requestOptions\n    );\n    const responseJSON = await response.json();\n\n    console.info("Printing registration result");\n    console.info(responseJSON);\n\n    return responseJSON;\n  } catch (e) {\n    console.error("There was an issue sending your registration response");\n    console.error(e.message);\n    throw e;\n  }\n}\n')),(0,o.kt)("h2",{id:"authentication-methods"},"Authentication methods"),(0,o.kt)("p",null,"The following methods will be used for authenticating with a passkey. For the remainder of this section, any use of assertion will refer to authentication."),(0,o.kt)("h3",{id:"get-assertion-options"},"Get assertion options"),(0,o.kt)("p",null,"This method will allow you to get the assertion options from your relying party."),(0,o.kt)("p",null,"More details on these properties can be found on the ",(0,o.kt)("a",{parentName:"p",href:"/docs/relying-party/auth-flow#request"},"relying party authentication flow page"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'async function getAssertionOptions(username) {\n  try {\n    const reqData = {\n      userName: username,\n    };\n\n    const requestOptions = {\n      method: "POST",\n      headers: {\n        "Content-Type": "application/json",\n      },\n      body: JSON.stringify(reqData),\n    };\n\n    const response = await fetch(\n      `${baseURL}/assertion/options`,\n      requestOptions\n    );\n    const responseJSON = await response.json();\n\n    console.info("Printing authentication options");\n    console.info(responseJSON);\n\n    return responseJSON;\n  } catch (e) {\n    console.error("There was an issue getting your authentication options");\n    console.error(e.message);\n    throw e;\n  }\n}\n')),(0,o.kt)("h3",{id:"send-assertion-result"},"Send assertion result"),(0,o.kt)("p",null,"This method will allow you to send a signed challenge to the relying party to validate if the user should be authenticated."),(0,o.kt)("p",null,"More details on these properties can be found on the ",(0,o.kt)("a",{parentName:"p",href:"/docs/relying-party/auth-flow#request-1"},"relying party authentication flow page"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'async function sendAssertionResult(requestID, assertionResult) {\n  try {\n    const reqData = {\n      requestId: requestID,\n      assertionResult: assertionResult,\n    };\n\n    const requestOptions = {\n      method: "POST",\n      headers: {\n        "Content-Type": "application/json",\n      },\n      body: JSON.stringify(reqData),\n    };\n\n    const response = await fetch(`${baseURL}/assertion/result`, requestOptions);\n    const responseJSON = await response.json();\n\n    console.info("Printing authentication result");\n    console.info(responseJSON);\n\n    return responseJSON;\n  } catch (e) {\n    console.error("There was an issue sending your authentication response");\n    console.error(e.message);\n    throw e;\n  }\n}\n')),(0,o.kt)("h2",{id:"credential-management-apis"},"Credential management APIs"),(0,o.kt)("p",null,"The following methods will be used to allow the user to manage their credentials. These methods will allow a user to view and manage passkeys through the lifecycle of their account. The methods included below will list, update, and delete passkeys from an account."),(0,o.kt)("h3",{id:"get-all-passkeys"},"Get all passkeys"),(0,o.kt)("p",null,"This method will allow you to list all of the passkeys that belong to a specific user"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'async function getCredentials(username) {\n  try {\n    const requestOptions = {\n      method: "GET",\n      headers: {\n        "Content-Type": "application/json",\n      },\n    };\n\n    const response = await fetch(\n      `${baseURL}/user/credentials/${username}`,\n      requestOptions\n    );\n    const responseJSON = await response.json();\n\n    console.info(`Printing credentials list for ${username}`);\n    console.info(responseJSON);\n\n    return responseJSON;\n  } catch (e) {\n    console.error("There was an issue getting your credentials");\n    console.error(e.message);\n    throw e;\n  }\n}\n')),(0,o.kt)("h3",{id:"delete-passkey"},"Delete passkey"),(0,o.kt)("p",null,"This method will allow you to delete a specific passkey from your account"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'async function deleteCredential(credentialId) {\n  try {\n    const reqData = {\n      id: credentialId,\n    };\n\n    const requestOptions = {\n      method: "DELETE",\n      headers: {\n        "Content-Type": "application/json",\n      },\n      body: JSON.stringify(reqData),\n    };\n\n    const response = await fetch(`${baseURL}/user/credentials`, requestOptions);\n    const responseJSON = await response.json();\n\n    return responseJSON;\n  } catch (e) {\n    console.error("There was an issue getting your credentials");\n    console.error(e.message);\n    throw e;\n  }\n}\n')),(0,o.kt)("h3",{id:"rename-passkey"},"Rename passkey"),(0,o.kt)("p",null,"This method will allow you to edit a passkeys username, that can be used to help a user more easily identify passkeys in their account."),(0,o.kt)("p",null,"Note that this does not edit the passkey itself, only the metadata that is associated to it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'async function updateCredential(credentialId, newNickname) {\n  try {\n    const reqData = {\n      id: credentialId,\n      nickName: newNickname,\n    };\n\n    const requestOptions = {\n      method: "PUT",\n      headers: {\n        "Content-Type": "application/json",\n      },\n      body: JSON.stringify(reqData),\n    };\n\n    const response = await fetch(`${baseURL}/user/credentials`, requestOptions);\n    const responseJSON = await response.json();\n\n    return responseJSON;\n  } catch (e) {\n    console.error("There was an issue getting your credentials");\n    console.error(e.message);\n    throw e;\n  }\n}\n')))}d.isMDXComponent=!0}}]);